{% extends 'templates/app.twig' %}
{% block content %}
    <div id="load">
    </div>
    <div id="wrapper-content">
        <div id="page-wrapper">
            <div class="main-content">
                <div class="content">
                    <div class="section section-padding choose-course">
                        <div class="container">
                            <div class="section teacher-course">
                                <div class="container teacher-course-wrapper">
                                    <div class="course-table">
                                            <form class="bg-w-form contact-form" method="post" autccomplete="off" enctype="multipart/form-data"
                                                  id="FormRegistrarOlla" name="FormRegistrarOlla">
                                                    <div class="group-title-index">
                                                        <h4 class="top-title">FORMULARIO</h4>
                                                        <h2 class="center-title">Información para la geolocalización de ollas comunes</h2>
                                                        <div class="bottom-title"><i class="fa fa-globe"></i></div>
                                                    </div>

                                                    <div class="col-md-12">
                                                        <label class="control-label form-label">
                                                            ¿En qué distrito se ubica la olla común? 
                                                            <span class="highlight">*</span>
                                                        </label>

                                                        <select class="form-control form-select obligate" id="distrito" value="" name="distrito"
                                                                data-content="Usted debe seleccionar el distrito.">
                                                            <option value=""> Seleccione un distrito</option>
                                                            <option value="1251"> CERCADO DE LIMA</option>
                                                            <option value="1252"> ANCON</option>
                                                            <option value="1253"> ATE</option>
                                                            <option value="1254"> BARRANCO</option>
                                                            <option value="1255"> BREÑA</option>
                                                            <option value="1256"> CARABAYLLO</option>
                                                            <option value="1257"> CHACLACAYO</option>
                                                            <option value="1258"> CHORRILLOS</option>
                                                            <option value="1259"> CIENEGUILLA</option>
                                                            <option value="1260"> COMAS</option>
                                                            <option value="1261"> EL AGUSTINO</option>
                                                            <option value="1262"> INDEPENDENCIA</option>
                                                            <option value="1263"> JESUS MARIA</option>
                                                            <option value="1264"> LA MOLINA</option>
                                                            <option value="1265"> LA VICTORIA</option>
                                                            <option value="1266"> LINCE</option>
                                                            <option value="1267"> LOS OLIVOS</option>
                                                            <option value="1268"> LURIGANCHO</option>
                                                            <option value="1269"> LURIN</option>
                                                            <option value="1270"> MAGDALENA DEL MAR</option>
                                                            <option value="1271"> MAGDALENA VIEJA</option>
                                                            <option value="1272"> MIRAFLORES</option>
                                                            <option value="1273"> PACHACAMAC</option>
                                                            <option value="1274"> PUCUSANA</option>
                                                            <option value="1275"> PUENTE PIEDRA</option>
                                                            <option value="1276"> PUNTA HERMOSA</option>
                                                            <option value="1277"> PUNTA NEGRA</option>
                                                            <option value="1278"> RIMAC</option>
                                                            <option value="1279"> SAN BARTOLO</option>
                                                            <option value="1280"> SAN BORJA</option>
                                                            <option value="1281"> SAN ISIDRO</option>
                                                            <option value="1282"> SAN JUAN DE LURIGANCHO</option>
                                                            <option value="1283"> SAN JUAN DE MIRAFLORES</option>
                                                            <option value="1284"> SAN LUIS</option>
                                                            <option value="1285"> SAN MARTIN DE PORRES</option>
                                                            <option value="1286"> SAN MIGUEL</option>
                                                            <option value="1287"> SANTA ANITA</option>
                                                            <option value="1288"> SANTA MARIA DEL MAR</option>
                                                            <option value="1289"> SANTA ROSA</option>
                                                            <option value="1290"> SANTIAGO DE SURCO</option>
                                                            <option value="1291"> SURQUILLO</option>
                                                            <option value="1292"> VILLA EL SALVADOR</option>
                                                            <option value="1293"> VILLA MARIA DEL TRIUNFO</option>
                                                        </select>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <label class="control-label form-label">Nombre de Olla Común<span
                                                                class="highlight">*</span></label>
                                                        <input type="text"
                                                               placeholder="Ingrese el nombre de la olla común"
                                                               id="nombre_olla"
                                                               name="nombre_olla"
                                                               data-content="Ingrese el nombre de la olla común"
                                                               class="form-control form-input obligate" value="">
                                                    </div>
                                                    <div class="col-md-6">
                                                        <label class="control-label form-label ">Nombre del/la representante <span class="highlight">*</span></label>
                                                        <input type="text"
                                                               placeholder="Ingrese el nombre del/la representante"
                                                               id="nombre_contacto" name="nombre_contacto"
                                                               class="form-control form-input obligate"
                                                               data-content="Usted debe ingresar el nombre del/la representante."
                                                               value="">
                                                    </div>
                                                    <div class="col-md-6">
                                                        <label class="control-label form-label">Número de celular<span class="highlight">*</span></label>
                                                        <input type="text"
                                                               placeholder="Ingrese el celular del/la representantel"
                                                               id="celular_contacto" name="celular_contacto"
                                                               class="form-control form-input obligate"
                                                               value=""
                                                               onkeypress="return validarnu(event)"
                                                               data-content="Usted debe ingresar el celular del/la representante.">
                                                    </div>
                                                    <div class="col-md-6">
                                                        <label class="control-label form-label">Número de Raciones<span class="highlight">*</span></label>
                                                        <input type="text"
                                                               placeholder="Ingrese el número de raciones"
                                                               id="raciones" name="raciones"
                                                               class="form-control form-input obligate"
                                                               value=""
                                                               maxlength="9"
                                                               onkeypress="return validarnu(event)"
                                                               data-content="Usted debe ingresar el número de raciones.">
                                                    </div>
                                                
                                               
                                                <div class="col-sm-12">
                                                     <hr>
                                                    <p>Toda información colocada en el presente formulario se utilizará con fines públicos respecto a la iniciativa Manos a la Olla.</p>
                                                </div>

                                                    <div class="col-sm-12 msg"></div>

                                                    <div class="col-sm-12 barra mybarra"></div>

                                                    <div class="contact-submit registraolla">
                                                        <button style="margin-top: 50px;" type="button" id="registrar" name="registrar" class="btn btn-success">
                                                            <span>
                                                                REGISTRAR INFORMACIÓN
                                                            </span>
                                                        </button>
                                                    </div>
                                                    {{ csrf.field | raw }}
                                            </form>
                                        </div>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="myModalInformation" tabindex="-1" role="dialog" aria-labelledby="myModalInformation">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header mod">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true" style="color:#fff;">&times;</span></button>
                    <h4 class="modal-title modtitle" id="myModalInformation">[ INFORMACIÓN ] </h4>
                </div>
                <div class="modal-body">
                    cargando contenido...espere un momento por favor
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <script>

        !function (a) {
            "use strict";

            a(function () {
                var b = a(window),
                        c = a(document.body),
                        mensaje = '',
                        tipo = '',
                        codigo = '';

                $('.registraolla').click(function () {
                    var b = a(this), dataString;
                    var holder = '';
                    var exito = true;

                    $(".obligate").each(function () {
                        if ($(this).val() == '') {
                            $(this).focus();
                            holder = $(this).attr("data-content");
                            exito = false;
                            $(".msg").html("").show();
                            $(".msg").html("<div class='alert alert-danger'><i class='fa fa-exclamation-triangle'></i> " + holder + "</div>");
                            setTimeout(function () {
                                $(".msg").fadeOut(1500);
                            }, 1500);
                            return false;
                        }
                    });

                    if (!exito)
                        return false;


                    var formData = new FormData($("#FormRegistrarOlla")[0]);

                    $.ajax({
                        type: "POST",
                        url: "{{ base_url() }}/registrar-simple",
                        data: formData,
                        contentType: false,
                        processData: false,
                        dataType: 'json',
                        beforeSend: function () {
                            $("#registrar").attr("disabled", true);
                            $('.barra').html("<div class='progress progress-sm active'><div class='progress-bar progress-bar-success progress-bar-striped' role='progressbar' aria-valuenow='20' aria-valuemin='0' aria-valuemax='100' style='width: 100%'><span class='sr-only'>20% Complete</span></div></div>");

                        },
                        success: function (data) {
                            if (data.response == 'success') {
                                $('#myModalInformation').find(".modal-body").html(data.message);
                                $('#myModalInformation').modal('show');
                                setTimeout(function () {
                                    window.location.href = window.location;
                                }, 1500);
                            } else {
                                $('.msg').html(data.message);
                                $("#registrar").attr("disabled", false);
                            }
                        },
                        error: function () {
                            console.log("It failed");
                        }
                    })
                });

            })
        }

        (jQuery), function () {
            "use strict";
            $('#fono').keyup(function () {
                this.value = (this.value + '').replace(/[^0-9]/g, '');
            });

        }();




        function validarnu(e) {
            tecla = (document.all) ? e.keyCode : e.which;
            if (tecla == 8)
                return true;
            patron = /\d/;
            te = String.fromCharCode(tecla);
            return patron.test(te);
        }

        function validarle(e) {
            tecla = (document.all) ? e.keyCode : e.which;
            if (tecla == 8)
                return true; // 3
            patron = /[A-Za-z\sñ á é í ó ú Á É Í Ó Ú Ñ]/;
            te = String.fromCharCode(tecla);
            return patron.test(te);
        }


        $(document).on('show.bs.modal', '.modal', function (event) {
            var zIndex = 1040 + (10 * $('.modal:visible').length);
            $(this).css('z-index', zIndex);
            setTimeout(function () {
                $('.modal-backdrop').not('.modal-stack').css('z-index', zIndex - 1).addClass('modal-stack');
            }, 0);
        });

    </script>
{% endblock content %}